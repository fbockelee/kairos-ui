##
#set( $jdbcTool = $loader.newInstance("JdbcTool") )
$jdbcTool.setAllFromConfig($project.specificVariables)##
$jdbcTool.setOrderby("ORDER BY ext2, ext4, ext3")##
#set( $extAttributes=$jdbcTool.getExtFieldAttributes($entity))
#set( $extTabAttributes=$jdbcTool.getExtTabAttributes($entity))
##
#set ( $LCentityName = $fn.uncapitalize($entity.name) )
<!-- File generated by $generator.name ( version $generator.version ) - Date $today.date("yyyy-MM-dd") ( Time $today.time ) --> 

<p-panel>
<p-header>
<table><tr>
<td><h2>{{ title }}</h2></td>
<td><button pButton type="button" label="Liste de ${entity.name}" class="ui-button-rounded" icon="pi pi-list" routerLink="/${LCentityName}-list"></button></td>
</tr></table>
</p-header>
<form [formGroup]="form" novalidate (ngSubmit)="save()">
#foreach ( $extattrib in $extAttributes)
#set ($attrib = $entity.attributes.get($extattrib.index))
#if ($attrib.isDatabaseNotNull())
	#set ($requiredmode = "required ")
#else
	#set ($requiredmode = "")
#end
#if ( ${attrib.databaseSize} > 60 )
	#set ($showsize = "600px ")
#else
	#set ($showsize = "${attrib.databaseSize}0px")
#end
#if ($extattrib.entertabs)
      <p-tabView>
#end
#if ($extattrib.entertab)
#set ($libtab = "")
#foreach ( $exttabattrib in $extTabAttributes)
#if ($exttabattrib.columnname == $extattrib.ext2)
#set ($libtab = $exttabattrib.ext1)
#end
#end
      <p-tabPanel header="${libtab}">
#end
#if ($extattrib.enterbloc)
    <div class="p-grid">
#end
#if ($extattrib.type == "field")
#if ($attrib.isKeyElement() && !$attrib.isFK())
    	<div class="p-col-1">   	
			<div class="box">
				<div>${extattrib.ext1}</div>
			</div>
	    </div>
    	<div class="p-col-5">
    		<div class="box">   	
				<input type="text" pInputText $requiredmode maxlength="${attrib.databaseSize}" formControlName="${attrib.name}" [ngStyle]="{'width':'${showsize}'}"/>
			</div>
	    </div>
    	<div class="p-col-6"></div>
#elseif ($attrib.isDateType())
    	<div class="p-col-1">   	
			<div class="box">	
				<div>${extattrib.ext1}</div>
			</div>
	    </div>
    	<div class="p-col-5">
    		<div class="box">  
				<p-calendar formControlName="${attrib.name}" dateFormat="dd/mm/yy" ${requiredmode}  [showIcon]="true"></p-calendar> 
			</div>
	    </div>
    	<div class="p-col-6"></div>
#elseif ( $attrib.isFK() && $attrib.isKeyElement())
#set($referencedEntity = $fn.uncapitalize($attrib.referencedEntityName))
#set($keyAttrib = $attrib.referencedEntity.keyAttribute.name)
    	<div class="p-col-1">   	
			<div class="box">
				<div>${extattrib.ext1}</div>
			</div>
	    </div>
    	<div class="p-col-5">
    		<div class="box">   
          		<mat-select formControlName="${attrib.name}" name="${referencedEntity}" class="form-full-width">
            		<mat-option [value]="">
              		N/A
            		</mat-option>
            		<mat-option *ngFor="let ${referencedEntity} of ${referencedEntity}sData" [value]="${referencedEntity}.$keyAttrib">
#foreach ( $refAttrib in $attrib.referencedEntity.attributes)
#if ($foreach.count < $attrib.referencedEntity.attributes.size())
#if ($refAttrib.isKeyElement())
#set($options = "{{ ${referencedEntity}.$keyAttrib }} | ")
#else
#set($options = $options + "{{ ${referencedEntity}.${refAttrib.name} }} - ")
#end
#else
#set($options = $options + "{{ ${referencedEntity}.${refAttrib.name} }}")
#end
#end
              		$options
            		</mat-option>
          		</mat-select>
			</div>
	    </div>
    	<div class="p-col-6"></div>
#elseif ( $attrib.isFK() )
#set($referencedEntity = $fn.uncapitalize($attrib.referencedEntityName))
#set($keyAttrib = $attrib.referencedEntity.keyAttribute.name)
    	<div class="p-col-1">   	
			<div class="box">	
				<div>${extattrib.ext1}</div>
			</div>
	    </div>
    	<div class="p-col-5">
    		<div class="box">   
          		<mat-select formControlName="${attrib.name}" name="${referencedEntity}" class="form-full-width">
            		<mat-option [value]="">
              			N/A
            		</mat-option>
            		<mat-option *ngFor="let ${referencedEntity} of ${referencedEntity}sData" [value]="${referencedEntity}.$keyAttrib">
#foreach ( $refAttrib in $attrib.referencedEntity.attributes)
#if ($foreach.count < $attrib.referencedEntity.attributes.size())
#if ($refAttrib.isKeyElement())
#set($options = "{{ ${referencedEntity}.$keyAttrib }} | ")
#else
#set($options = $options + "{{ ${referencedEntity}.${refAttrib.name} }} - ")
#end
#else
#set($options = $options + "{{ ${referencedEntity}.${refAttrib.name} }}")
#end
#end
              			$options
            			</mat-option>
          		</mat-select>
			</div>
	    </div>
    	<div class="p-col-6"></div>
#elseif ( $attrib.isBooleanType())
    	<div class="p-col-1">   	
			<div class="box">	
				<div>${extattrib.ext1}</div>
			</div>
	    </div>
    	<div class="p-col-5">
    		<div class="box">   
				<p-checkbox formControlName="${attrib.name}" binary="true"></p-checkbox>
			</div>
	    </div>
    	<div class="p-col-6"></div>
#elseif ( $extattrib.ext7 != '')
#if ($extattrib.ext7.substring(0,4)=="lov_")
    	<div class="p-col-1">   	
			<div class="box">	
				<div>${extattrib.ext1}</div>
			</div>
	    </div>
    	<div class="p-col-5">
    		<div class="box">   
				<p-dropdown [options]="listOf${extattrib.ext7.substring(4)}_itm" $requiredmode formControlName="${attrib.name}" placeholder="" label="codeelement"
	  					menu-btn [style]="{'width': '400px'}">
    			</p-dropdown>
			</div>
	    </div>
    	<div class="p-col-6"></div>
#end
#if ($extattrib.ext7=="inp_password")
    	<div class="p-col-1">   	
			<div class="box">	
				<div>${extattrib.ext1}</div>
			</div>
	    </div>
    	<div class="p-col-5">
    		<div class="box">   
				<input type="password" pPassword $requiredmode maxlength="${attrib.databaseSize}" formControlName="${attrib.name}" [ngStyle]="{'width':'${showsize}'}"/>	         
			</div>
	    </div>
    	<div class="p-col-6"></div>
#end
#else
    	<div class="p-col-1">   	
			<div class="box">	
				<div>${extattrib.ext1}</div>
			</div>
	    </div>
    	<div class="p-col-5">
    		<div class="box"> 	
#set ($field_align="")
#if ($attrib.isNumberType())
#set ($field_align="text-align: right;")
#end
				<input type="text" pInputText $requiredmode maxlength="${attrib.databaseSize}" formControlName="${attrib.name}" [ngStyle]="{'width':'${showsize}'}"/>
			</div>
	    </div>
    	<div class="p-col-6"></div>
#end
#end
#if ($extattrib.type == "fieldlink")
    	<div class="p-col-1">   	
			<div class="box">	
				<div>${extattrib.ext1}</div>
			</div>
	    </div>
    	<div class="p-col-11">
    		<div class="box"> 
				<app-${extattrib.columnname}-list [filter]="filter_${extattrib.columnname}"></app-${extattrib.columnname}-list>
			</div>
	    </div>
#end
#if ($extattrib.ext5 == "o" )
#else
#if (!$extattrib.leavebloc)
#end
#end 
#if ($extattrib.leavebloc)
      </div>
#end
#if ($extattrib.leavetab)
      </p-tabPanel>
#end
#if ($extattrib.leavetabs)
      </p-tabView>
#end
#end
    <p-footer>
    	<button pButton type="button" label="Vider" class="ui-button-rounded" (click)="initForm()"></button>
    	<button pButton type="button" label="Sauvegarder" class="ui-button-rounded" [disabled]="!form.valid" icon="pi pi-check" (click)="save()"></button>
#set ($entityNameprefix = "!${LCentityName}?.")
    	<button pButton type="button" label="Supprimer" class="ui-button-rounded ui-button-secondary" [disabled]="${entity.keyAttributesNamesAsString(' && ', $entityNameprefix, '')}" icon="pi pi-trash" (click)="deleteConfirmation()"></button>
	</p-footer>
</form>
</p-panel>